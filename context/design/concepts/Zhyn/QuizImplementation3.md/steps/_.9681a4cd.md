---
timestamp: 'Wed Oct 15 2025 18:36:11 GMT-0400 (Eastern Daylight Time)'
parent: '[[..\20251015_183611.80879aea.md]]'
content_id: 9681a4cd77e60be8b3a372e5df3e39d8b3db7b763bb31c5ff03d6a6973967695
---

# Documentation

Every concept should have inline documentation and commenting:

* The concept itself should be paired with its purpose.
* The state should be described next to any types.
* Any testing should be guided by the principle.
* Each action should state the requirements and effects, and tests should check that both work against variations.

**concept** Quiz \[Character, ZhuyinRep]

**purpose** To enable users to practice and improve their Zhuyin typing skills by providing immediate and aggregated feedback on their speed and accuracy for individual characters.

**principle** If a user starts a quiz, answers multiple questions, and when the timer runs out they will receive a summary of their performance, including overall average speed and accuracy, and a list of specific characters they struggled with, allowing them to focus their practice.

**state**\
a set of QuizEntries with\
  a quizId String\
  a length Number (seconds)\
  a questionList set of Questions\
  a incorrectList set of IncorrectRecords\
  an activeQuestionId String\
  a questionCount Number\
  a completedCount Number\
  an avgSpeed Number\
  an avgAccuracy Number\
  an expiryTime DateTime?

a set of Questions with\
  an questionId String\
  a character Character\
  a target ZhuyinRep\
  a response ZhuyinRep?\
  a startTime DateTime?\
  an endTime DateTime?\
  a speed Number?\
  a correct Boolean?

a set of IncorrectRecords with\
  a character Character\
  a target ZhuyinRep\
  a response ZhuyinRep

**actions**\
makeQuiz (length: Number): quizId: String\
  effects create a new QuizEntry with new quizId, length=length, empty questionList, empty incorrectList, activeQuestionId = "", questionCount=0, completedCount=0, avgSpeed=0, avdAccuracy=0. expiryTime unset. Return quizId.

endQuiz (quizId: String): {\[avgSpeed: Number, avgAccuracy: Number, incorrectRecords\[]]}\
  requires expiryTime < current time\
  effects return \[avgSpeed, avgAccuracy, incorrectList] corresponding to quizId

registerQuestion (quizId: String, Character, ZhuyinRep): (questionId: String)\
  requires quizId exists, Character and ZhuyinRep are a valid pair in ZhuyinDict\
  effects\
  Get QuizEntry with quizId.\
  Generate a questionId.\
  Create new Question with questionId, Character, and target ZhuyinRep, other fields unset.\
  Set QuizEntry questionCount += 1.\
  Add questionId to QuizEntry questionList.\
  Return questionId.

startQuestion (quizId: String, questionId: String)\
  requires questionId in QuizEntry questionList, QuizEntry activeQuestionId is empty string\
  effects\
  get QuizEntry corresponding to quizId\
  if expiryTime unset: set expiryTime = current time + length (in essence, begin quiz when user attempts first question)\
  update startTime of coresponding Question to current time\
  set QuizEntry activeQuestionId = questionId

submitAnswer (quizId, questionId: String, response: ZhuyinRep)\
  requires QuizEntry activeQuestionId === questionId\
  effects\
  set Question endTime = current time\
  set Question response = response\
  set Question speed = endTime - startTime (in milliseconds)\
  set Question correct = (response = target)\
  set QuizEntry activeQuestionId = "" (empty string)\
  set QuizEntry completedCount += 1\
  if correct == False: create new IncorrectRecord and add to Quiz incorrectList\
  set QuizEntry avgSpeed = *new avg speed calculated by [incremental average formula](#incremental-average-formula)*\
  set QuizEntry avgAccuracy = *new avg accuracy calculated by [incremental average formula](#incremental-average-formula)*

**sync** registerQuestion\
*when*\
  Quiz.registerQuestion (Character, providedZhuyinRep: ZhuyinRep)\
*where*\
  ZhuyinDictionary.getAnswer(Character): (registeredZhuyinRep: ZhuyinRep)\
*then*\
  if providedZhuyinRep === registeredZhuyinRep: Quiz.registerQuestion(Character, registeredZhuyinRep: ZhuyinRep): (questionId: String)\
  else: error

**sync** endQuiz\
*when*\
  system.currentTime == QuizEntry.expiryTime\
*then*\
  Quiz.endQuiz()

**NOTES**

#### Incremental average formula:

( Old Average \* Old Count + New Value ) / New Count
