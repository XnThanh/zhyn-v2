---
timestamp: 'Wed Oct 15 2025 03:35:10 GMT-0400 (Eastern Daylight Time)'
parent: '[[..\20251015_033510.c76c6a5d.md]]'
content_id: a7e83ab185296592c36fac6627b53b828d640b939a761128864d6f8e3027f246
---

# Test implementation

While testing, use the `testDb` function, which returns a tuple of the database and client so that you can close it.

```typescript
import { testDb } from "@utils/database.ts";

Deno.test("...", async () => {
  const [db, client] = await testDb();

  // ... tests

  await client.close();
});
```

The database is already automatically dropped before every test file using the `Deno.test.beforeAll` hook: do not include any additional manipulation of the database for this purpose.

Use the Deno.test framework, splitting by appropriate test steps and describing each behavior. Import helpers from:

```typescript
import { assertEquals } from "jsr:@std/assert"; // or any other utility from the library
```

**concept** Quiz

**purpose** track User's Zhuyin typing ability

**principle** track the speed and accuracy for each Character that user typed

**state**\
a set of Questions with\
  an questionId String\
  a character Character\
  a target ZhuyinRep\
  a response ZhuyinRep?\
  a startTime DateTime?\
  an endTime DateTime?\
  a speed Number?\
  a correct Boolean?

**actions**\
register (Character, ZhuyinRep): (questionId: String)\
  effect Generate a questionId. Create a new Question with questionId, associated character and target ZhuyinRep, other fields unset. Return questionId.

startQuestion (questionId: String)\
  requires Question exists and not already started (startTime is unset)\
  effects update startTime of coresponding Question to current time

submitAnswer (questionId: String, response: ZhuyinRep)\
  requires Question exists and started, with endTime unset\
  effects\
  set endTime = current time\
  set response = response\
  set speed = endTime - startTime (in milliseconds)\
  set correct = (response = target)

**queries**\
getSpeed (questionId: String): (speed: Number)\
  requires Question exists and endTime set\
  effect return speed associated with Question

getAccuracy (questionId: String): (correct: Boolean)\
  requires Question exists and endTime set\
  effect return correct Boolean associated with Question
