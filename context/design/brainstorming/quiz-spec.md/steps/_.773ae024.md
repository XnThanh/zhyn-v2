---
timestamp: 'Wed Oct 15 2025 18:18:03 GMT-0400 (Eastern Daylight Time)'
parent: '[[..\20251015_181803.96f5122a.md]]'
content_id: 773ae024f61c3ffb998a33bbdbc0c9ae9c170073b673f8200186aff3526cb4c1
---

# Documentation

Every concept should have inline documentation and commenting:

* The concept itself should be paired with its purpose.
* The state should be described next to any types.
* Any testing should be guided by the principle.
* Each action should state the requirements and effects, and tests should check that both work against variations.

**concept** Quiz

**purpose** track User's Zhuyin typing ability

**principle** track and compiles the speed and accuracy for Characters that user typed

**state**\
a set of QuizEntries with\
  a quizId String\
  a length Number (seconds)\
  a set of questionList Questions\
  a set of incorrectList IncorrectRecords\
  an activeQuestionId String\
  a questionCount Number\
  a completedCount Number\
  an avgSpeed Number\
  an avgAccuracy Number\
  an expiryTime DateTime?

a set of Questions with\
  an questionId String\
  a character Character\
  a target ZhuyinRep\
  a response ZhuyinRep?\
  a startTime DateTime?\
  an endTime DateTime?\
  a speed Number?\
  a correct Boolean?

a set of IncorrectRecords with\
  a character Character\
  a target ZhuyinRep\
  a response ZhuyinRep

**actions**\
makeQuiz (length: Number): quizId: String\
  effects create a new QuizEntry with new quizId, length=length, empty questionList, empty incorrectList, activeQuestionId = "", questionCount=0, completedCount=0, avgSpeed=0, avdAccuracy=0. expiryTime unset. Return quizId.

endQuiz (quizId: String): \[avgSpeed: Number, avgAccuracy: Number, incorrectRecords\[]]\
  requires expiryTime < current time\
  effects return \[avgSpeed, avgAccuracy, incorrectList] corresponding to quizId

registerQuestion (quizId: String, Character, ZhuyinRep): (questionId: String)\
  requires quizId exists, Character and ZhuyinRep are a valid pair in ZhuyinDict\
  effects\
  Get QuizEntry with quizId.\
  Generate a questionId.\
  Create new Question with questionId, Character, and target ZhuyinRep, other fields unset.\
  Set QuizEntry questionCount += 1.\
  Add questionId to QuizEntry questionList.\
  Return questionId.

startQuestion (quizId: String, questionId: String)\
  requires questionId in QuizEntry questionList, QuizEntry activeQuestionId is empty string\
  effects\
  get QuizEntry corresponding to quizId\
  if expiryTime unset: set expiryTime = current time + length (in essence, begin quiz when user attempts first question)\
  update startTime of coresponding Question to current time\
  set QuizEntry activeQuestionId = questionId

submitAnswer (quizId, questionId: String, response: ZhuyinRep)\
  requires QuizEntry activeQuestionId === questionId\
  effects\
  set Question endTime = current time\
  set Question response = response\
  set Question speed = endTime - startTime (in milliseconds)\
  set Question correct = (response = target)\
  set QuizEntry activeQuestionId = "" (empty string)\
  set QuizEntry completedCount += 1\
  if correct == False: create new IncorrectRecord and add to Quiz incorrectList\
  set QuizEntry avgSpeed = *new avg speed calculated by [incremental average formula](#incremental-average-formula)*\
  set QuizEntry avgAccuracy = *new avg accuracy calculated by [incremental average formula](#incremental-average-formula)*

**queries**\
getSpeed (questionId: String): (speed: Number)\
  requires Question exists and endTime set\
  effect return speed associated with Question

getAccuracy (questionId: String): (correct: Boolean)\
  requires Question exists and endTime set\
  effect return correct Boolean associated with Question

**sync** registerQuestion\
*when*\
  Quiz.registerQuestion (Character, providedZhuyinRep: ZhuyinRep)\
*where*\
  ZhuyinDictionary.getAnswer(Character): (registeredZhuyinRep: ZhuyinRep)\
*then*\
  if providedZhuyinRep === registeredZhuyinRep: Quiz.registerQuestion(Character, registeredZhuyinRep: ZhuyinRep): (questionId: String)\
  else: error

**sync** endQuiz\
*when*\
  system.currentTime == QuizEntry.expiryTime\
*then*\
  Quiz.endQuiz()

**NOTES**

#### Incremental average formula:

( Old Average \* Old Count + New Value ) / New Count
